# Inherit parent devshell (Nix flake + .env secrets)
source_up

# Ensure rustup's toolchain (controlled by rust-toolchain.toml) takes priority
# over the Nix-provided rustc 1.82 which is too old for our dependencies.
if has rustup; then
  RUSTUP_TOOLCHAIN_DIR="$(rustup which rustc 2>/dev/null | xargs dirname 2>/dev/null)"
  if [[ -n "$RUSTUP_TOOLCHAIN_DIR" ]]; then
    PATH_add "$RUSTUP_TOOLCHAIN_DIR"
  fi
fi

# Cargo bin for locally-installed tools
path_add PATH "$HOME/.cargo/bin"
